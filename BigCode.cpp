This is big code - from dev2 conflict
This is change in branch DEV1